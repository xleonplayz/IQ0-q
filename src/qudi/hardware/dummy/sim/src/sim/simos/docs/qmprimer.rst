.. _QMPrimer:

A Primer on Quantum Mechanics
=============================

Here, we try to cover the most essential concepts of quantum mechanics that are required to understand
the basics of spin dynamics simulations. They are neither excessive nor complete and do not replace
a course on quantum mechanics or the study of standard textbook literature or review articles [CCH24]_ [MD20]_.

If you are familiar with quantum mechanics. just continue from here and:

#. Familiarize yourself with our  :ref:`backends <Backends>` and implementations of basic :ref:`matrix operations <QMMethods>`.
#. Discover our :ref:`hands-on introduction <System>` on how to construct composite Hilbert spaces in SimOS.
#. Check out helper methods to onstruct :ref:`coherent <Coherent>` and :ref:`incoherent <incoherent>` interactions.
#. Simulate :ref:`time evolution <TimePropagation>` of Liovuille-von-Neumann, Liouville Master equations or explore our variable
   module for simulations of spatial dynamics (i.e. Stochastic Schrödinger/Liouville equations).


Closed Quantum Systems
----------------------

The time evolution of closed quantum systems is governed by coherent interactions which can be 
formulated as Hamiltonian operators :math:`\hat{H}` in the Hilbert space of the quantum system. 
If the system is in a pure state, represented by a state vector :math:`\ket{\psi}`, the time evolution is described by 
the Schrödinger equation.

.. math::
    \frac{\partial}{\partial t} \ket{\psi(t)} = -\frac{i}{\hbar} H \ket{\psi(t)} = -i \mathcal{H} \ket{\psi(t)}.

ODMR experiments are however often conducted on statistical ensembles of quantum systems, characterized by probability
distributions of a series of state vectors :math:`\{\ket{\psi_i}, p_i \}`. These mixed states are then represented with 
density matrices :math:`\rho = \sum_i p_i \ket{\psi_i}\bra{\psi_i}` and the time evolution is described by the 
Liouville-von-Neumann equation

.. math::
    \frac{\partial}{\partial t} \rho(t) = -i [\mathcal{H}, \rho(t)].

If the Hamiltonian :math:`\mathcal{H}` is stationary in time, the exact solution of the Schrödinger or 
the Liouville-von-Neumann equation is given by

.. math::
        \ket{\psi(t)} = e^{-\mathrm{i} \mathcal{H} t} \ket{\psi(t=0)} = U(t) \ket{\psi(t=0)} \quad\text{and}

.. math::
        \rho(t) = U(t) \, \rho(0)\, U^\dagger(t) \text{,}

respectively.
In SimOS,  the propagator :math:`U` as well as the evolved state vector :math:`\ket{\psi(t)}` or density matrix :math:`\rho(t)` can be computed
using the  :code:`evol` routine.
In the case of time-dependent Hamiltonians, we can compute the time evolution  using a time-ordered exponential. Esentially, we assume that 
the Hamiltonian is piecewise constant for small time intervals. We compute the time evolution for each time interval 
and obtain the overall evolution operator by multiplying the time evolution operators of the individual time intervals. Of course, this makes 
the simulation computationally expensive - we now have to compute a series instead of a single propagator. The :code:`prop` routine of SimOS
provides a routine to efficiently evolve quantum systems under time dependent Hamiltonian, leveraging paralellism and efficient
matrix exponentiation.   Both the initial system state :math:`\rho(0)` and the system Hamiltonian :math:`\hat{H}` can  be generated by either using 
the operators of a :class:`System` class instance or by making use of further "high-level" SimOS functionality.


Open Quantum Systems
--------------------

Systems featuring spin-dependent photoluminescence are typically open quantum systems. Their incoherent interaction with the
environment interferes with their coherent time evolution and an accurate simulation
of their dynamics requires a quantum master equation (QME). Since a QME enables a non-unitary time 
evolution of quantum states, a description with density matrices becomes mandatory and the combined coherent 
and incoherent system dynamics are formulated as superoperators in Liouville space. 
Multiple approximate QMEs exist and are preferentially utilized among specific scientific communities.
However not all of them generate completely positive time-evolution operators that preserve the trace 
of the density matrix (:math:`tr(\rho(t))=1`) throughout the time evolution. 
Importantly, if a QME does not generate a CPTP (completely positive trace preserving) map, 
it may produce solutions which are not physically sound and therefore require further correction. 

The Lindblad theorem states that the generator of any quantum operation satisfying the CPTP criterion 
property can be written in the form 

.. math::
    \frac{d}{dt} \hat{\rho} =  -\frac{i}{\hbar} [\hat{H}, \hat{\rho}] + \sum_k \left(\hat{L}_k\hat{\rho}\hat{L}_k^{\dagger} - \frac{1}{2} \{\hat{L}_k^{\dagger}\hat{L}_k \hat{\rho}\} \right) 

where :math:`[\cdot , \cdot]` and :math:`\{\cdot , \cdot\}` are the commutator 
and the anticommutator, :math:`\hat{H}` is the system Hamiltonian and :math:`\hat{L}_k` are collapse 
(or: jump) operators. 
The microscopic derivation of the Lindblad form involves several assumptions,
most importantly that the dynamics are Markovian and the system is weakly
damped such that the density matrix of the system remains separable from the bath's degrees of 
freedom at all times. 
The first part of the Lindblad master equation is the Liouville-von-Neumann equation that describes the coherent 
dynamics discussed in the previous paragraph.
When there are no incoherent contributions to the system dynamics,
the QME simplifies accordingly and can be propagated in Hilbert space.
The second part is a dissipative superoperator, allowing for incoherent, stochastic state transitions characterized by distinct
jump operators and transition rates. 
The  :code:`evol` and  :code:`prop` routines accept, in addition to (time-dependent) Hamiltonians list of collapse
operators as input arguments and support propagation in Liouville space. 



.. rubric:: References

.. [CCH24] Campaioli, F., Cole, J.H. and Hapuarachchi, H. Quantum Master Equations: Tips and Tricks for Quantum Optics, Quantum Computing, and Beyond. PRX Quantum 5, 020202 (2024).
.. [MD20] Manzano, D.A short introduction to the Lindblad master equation. AIP Advances 10, 025106 (2020).

